<!DOCTYPE html>
<html lang="zh-CN">
    <div class="export-buttons">
    <button onclick="exportZOI()" class="export-btn">ğŸ“¤ å¯¼å‡º ZOI æ¨¡æ¿</button>
    <button onclick="exportMIC()" class="export-btn">ğŸ“¤ å¯¼å‡º MIC æ¨¡æ¿</button>
    <button onclick="exportSchedule()" class="export-btn">ğŸ“¤ å¯¼å‡ºæ’ç­æ¨¡æ¿</button>
</div>

<style>
.export-buttons {
    margin: 20px 0;
    display: flex;
    gap: 12px;
}
.export-btn {
    padding: 10px 14px;
    background: #10b981;
    border: none;
    color: white;
    border-radius: 8px;
    font-size: 14px;
    cursor: pointer;
}
.export-btn:hover {
    background: #059669;
}
</style>

<head>
    <meta charset="UTF-8" />
    <title>æ•°æ®å½•å…¥ - æŠ—èŒå®éªŒç³»ç»Ÿ</title>
    <style>
        :root {
            --primary: #2E7D32;
            --primary-light: #A5D6A7;
            --bg: #F5F7FA;
            --text: #263238;
        }
        * { box-sizing: border-box; margin:0; padding:0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",å¾®è½¯é›…é»‘, sans-serif;
            background: var(--bg);
            color: var(--text);
        }
        header {
            background: white;
            border-bottom: 1px solid #E0E0E0;
            padding: 16px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        header h1 { font-size: 20px; color: var(--primary); }
        nav a {
            margin-left: 16px;
            text-decoration: none;
            color: var(--text);
            padding: 6px 10px;
            border-radius: 999px;
        }
        nav a:hover { background: var(--primary-light); color:white; }
        main {
            max-width: 1100px;
            margin: 24px auto;
            padding: 16px;
            display:grid;
            grid-template-columns: 320px 1fr;
            gap:16px;
        }
        .card {
            background:white;
            border-radius:12px;
            padding:16px;
            box-shadow:0 2px 6px rgba(0,0,0,0.05);
        }
        label { display:block; margin:8px 0 4px; font-size:13px; }
        input,select {
            width:100%;
            padding:6px 8px;
            border-radius:6px;
            border:1px solid #CFD8DC;
            font-size:13px;
        }
        .btn {
            border:none;
            background:var(--primary);
            color:white;
            padding:8px 14px;
            border-radius:999px;
            cursor:pointer;
            width:100%;
            margin-top:10px;
        }
        .btn:hover { background:#1B5E20; }
        table {
            width:100%;
            border-collapse:collapse;
            font-size:12px;
        }
        th,td {
            border:1px solid #ECEFF1;
            padding:6px 8px;
            text-align:center;
        }
        th { background:#E8F5E9; }
    </style>
</head>
<body>
<header>
    <h1>æ•°æ®å½•å…¥æ¨¡å—ï¼ˆZOI / MICï¼‰</h1>
    <nav>
        <a href="index.html">é¦–é¡µ</a>
        <a href="schedule.html">å®éªŒæ’ç­</a>
        <a href="layout.html">å®éªŒå¸ƒå±€</a>
        <a href="entry.html">æ•°æ®å½•å…¥</a>
        <a href="sop.html">SOP</a>
    </nav>
</header>
<main>
    <div class="card">
        <h3>æ–°è®°å½•å½•å…¥</h3>
        <label>å®éªŒæ–¹æ³•</label>
        <select id="method">
            <option value="ZOI">æŠ‘èŒåœˆç›´å¾„ (mm)</option>
            <option value="MIC">MIC æµ“åº¦ (%)</option>
        </select>

        <label>èŒæ ª</label>
        <select id="strain"></select>

        <label>æ¤ç‰©æå–ç‰©</label>
        <select id="extract"></select>

        <label>é‡å¤æ¬¡æ•°ï¼ˆRï¼‰</label>
        <input type="number" id="replicate" min="1" max="5" value="1" />

        <label>æ‰¹æ¬¡å·</label>
        <input type="text" id="batch" value="B001" />

        <label id="valueLabel">æŠ‘èŒåœˆç›´å¾„ (mm)</label>
        <input type="number" id="value" step="0.1" />

        <button class="btn" onclick="addRecord()">ä¿å­˜è®°å½•</button>
    </div>

    <div class="card">
        <h3>å·²å½•å…¥è®°å½•</h3>
        <table>
            <thead>
            <tr>
                <th>ID</th>
                <th>æ–¹æ³•</th>
                <th>èŒæ ª</th>
                <th>æå–ç‰©</th>
                <th>é‡å¤</th>
                <th>æ‰¹æ¬¡</th>
                <th>æ•°å€¼</th>
            </tr>
            </thead>
            <tbody id="dataBody"></tbody>
        </table>
    </div>
</main>

<script>
    const extracts = [
        "P1 æŸ‘æ©˜æœçš®","P2 çŸ³æ¦´çš®","P3 è‹¹æœçš®","P4 é¦™è•‰çš®",
        "P5 æ‡æ·å¶","P6 èŠèŠ±/é‡‘é“¶èŠ±","P7 ç»¿èŒ¶","P8 è–„è·",
        "P9 è¿·è¿­é¦™","P10 èŠ¦èŸ"
    ];
    const strains = ["EC","BS","AS","PS"];

    const data = [];

    function initForm(){
        const sSel = document.getElementById("strain");
        const eSel = document.getElementById("extract");
        strains.forEach(s=>{
            const o = document.createElement("option");
            o.value = s; o.textContent = s;
            sSel.appendChild(o);
        });
        extracts.forEach(p=>{
            const o = document.createElement("option");
            o.value = p; o.textContent = p;
            eSel.appendChild(o);
        });

        document.getElementById("method").addEventListener("change", e=>{
            const m = e.target.value;
            const lab = document.getElementById("valueLabel");
            if(m === "ZOI") lab.textContent = "æŠ‘èŒåœˆç›´å¾„ (mm)";
            else lab.textContent = "MIC æµ“åº¦ (%)";
        });
    }

    function addRecord(){
        const method = document.getElementById("method").value;
        const strain = document.getElementById("strain").value;
        const extract = document.getElementById("extract").value;
        const replicate = parseInt(document.getElementById("replicate").value,10);
        const batch = document.getElementById("batch").value;
        const value = parseFloat(document.getElementById("value").value);

        if(isNaN(value)){
            alert("è¯·å¡«å†™æ•°å€¼ã€‚");
            return;
        }
        if(method === "ZOI" && (value<0 || value>100)){
            alert("æŠ‘èŒåœˆç›´å¾„èŒƒå›´å¼‚å¸¸ï¼Œè¯·ç¡®è®¤ã€‚");
            return;
        }

        data.push({
            id: Date.now(),
            method, strain, extract, replicate, batch, value
        });
        renderTable();
        document.getElementById("value").value = "";
    }

    function renderTable(){
        const tbody = document.getElementById("dataBody");
        tbody.innerHTML = "";
        data.slice().reverse().forEach(row=>{
            const tr = document.createElement("tr");
            tr.innerHTML = `
                <td>${row.id}</td>
                <td>${row.method}</td>
                <td>${row.strain}</td>
                <td>${row.extract}</td>
                <td>R${row.replicate}</td>
                <td>${row.batch}</td>
                <td>${row.value}</td>
            `;
            tbody.appendChild(tr);
        });
    }

    initForm();
</script>
</body>
</html>

